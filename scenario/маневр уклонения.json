{
"scenario_id":"ИРЗ Целераспределение",

  "objects":
	[
      {
        "id": "SHIP_00",
        "title": "Корабль",
        "properties":[
            {"name": "class_code", "value": "131472600009", "type": "str"},
            {"name": "is_own", "value": 1, "type": "int"},
            {"name": "lat", "value": 43.53174, "type": "float"},
            {"name": "lon", "value": 39.46268, "type": "float"},
            {"name": "alt", "value": 0, "type": "int"},
            {"name": "course", "value":  0, "type": "float"},
            {"name": "speed", "value": 0, "type": "float"},
            {"name": "hull_damage", "value": 0, "type": "int"},
            {"name": "image", "value": "ship-blue.png", "type": "str"},
            {"name": "distance_threshold", "value": 500, "type": "float", "title": "порог расстояния для определения близких объектов (метры)"},
            {"name": "state", "value": "standing", "type": "str"}
        ],
        "actions": [
          {
            "name": "Маневр уклонения от атаки в бок",
            "type": "evasive_maneuver",
            "algorithm_id": "alg_id_evasive_maneuver",
            "output_mapping":[
              {"course":  "new_course"}
            ]
          }
        ]
      },

      {
          "id": "BEK_01",
          "title": "БЭК 1",
          "properties":
          [
            {"name": "class_code", "value": "10213", "type": "str"},
            {"name": "is_own", "value": 0, "type": "int"},
            {"name": "lat", "value": 43.626470178732255, "type": "float"},
            {"name": "lon", "value": 39.48991308634684, "type": "float"},
            {"name": "alt", "value": 0.0, "type": "float"},
            {"name": "course", "value": 184.19, "type": "float"},
            {"name": "speed", "value": 20.0, "type": "float"},
            {"name": "distance_of_defeat", "value": 7408, "type": "int"},
            {"name": "detection_distance", "value": 20000, "type": "int"},
            {"name": "rocket_count", "value": 2, "type": "int"},
            {"name": "target", "value": "SHIP_00", "type": "str", "title":  "идентификатор объекта поражения"},
            {"name": "state", "value": "moving", "type": "str"}
          ],
          "actions": [
            {
              "name": "движение",
              "type": "move",
              "algorithm_id": "alg_id_0",
              "output_mapping":  [ {"lat": "new_lat"}, {"lon":  "new_lon"} ]
            },
            {
              "name": "расчет курса для тарана цели",
              "type": "course_to_damage_ram",
              "algorithm_id": "alg_id_kamikaze",
              "output_mapping":  [
                {"state": "new_state"},
                {"course": "new_course"}
              ]
            }
          ]
        },

      {
        "id": "BEK_02",
        "title": "БЭК 2",
        "properties":
        [
          {"name": "class_code", "value": "10213", "type": "str"},
          {"name": "is_own", "value": 0, "type": "int"},
          {"name": "lat", "value": 43.610292063473096, "type": "float"},
          {"name": "lon", "value": 39.53649212169146, "type": "float"},
          {"name": "alt", "value": 0.0, "type": "float"},
          {"name": "course", "value": 269.68, "type": "float"},
          {"name": "speed", "value": 20.0, "type": "float"},
          {"name": "distance_of_defeat", "value": 7408, "type": "int"},
          {"name": "detection_distance", "value": 20000, "type": "int"},
          {"name": "rocket_count", "value": 2, "type": "int"},
          {"name": "target", "value": "SHIP_00", "type": "str", "title":  "идентификатор объекта поражения"},
          {"name": "state", "value": "moving", "type": "str"}
        ],
        "actions": [
          {
            "name": "движение",
            "type": "move",
            "algorithm_id": "alg_id_0",
            "output_mapping":  [ {"lat": "new_lat"}, {"lon":  "new_lon"} ]
          },
          {
            "name": "расчет курса для тарана цели",
            "type": "course_to_damage_ram",
            "algorithm_id": "alg_id_kamikaze",
            "output_mapping":  [
              {"state": "new_state"},
              {"course": "new_course"}
            ]
          }
        ]
      },


	  {
			"id":"Model_00",
			"title":"Среда взаимодействия",
			"properties":
            [
              {"name": "current_iteration", "value": 0, "type": "int"},
              {"name": "elapsed_time_in_sec", "value": 0, "type": "int"},
              {"name": "time_per_sec", "value": 1, "type": "int"},
              {"name": "lon", "value": 37.504, "type": "float"},
              {"name": "lat", "value": 42.915, "type": "float"},
              {"name": "alt", "value": 0.0, "type": "float"},
              {"name": "is_caught", "value": -1, "type": "int"},
              {"name": "point_exists", "value": 0, "type": "int"}
            ],
			"actions":[]
	  }

	],
    "classes": [],

    "interactions": [

      {
        "source_object_id": "SHIP_00",
        "interaction_type": "evasive_maneuver",
        "trigger_condition": "SHIP_00.properties['state'] == 'standing'",
        "response_action": "SHIP_00.actions.evasive_maneuver( ship=SHIP_00, all_items=self.objects, distance_threshold=SHIP_00.properties['distance_threshold'])"
      },

      {
        "source_object_id": "BEK_01",
        "interaction_type": "moving",
        "trigger_condition": "BEK_01.properties['target'] != '' ",
        "response_action": "BEK_01.actions.course_to_damage_ram(item=BEK_01, items=self.objects, target=BEK_01.properties['target'])"
      },
      {
        "source_object_id": "BEK_02",
        "interaction_type": "moving",
        "trigger_condition": "BEK_02.properties['target'] != '' ",
        "response_action": "BEK_02.actions.course_to_damage_ram(item=BEK_02, items=self.objects, target=BEK_02.properties['target'])"
      },
      {
        "source_object_id": "BEK_01",
        "interaction_type": "moving",
        "trigger_condition": "BEK_01.properties['state'] =='moving'",
        "response_action": "BEK_01.actions.move(item=BEK_01, time_in_seconds=self.second_in_iteration)"
      },
      {
        "source_object_id": "BEK_02",
        "interaction_type": "moving",
        "trigger_condition": "BEK_02.properties['state'] =='moving'",
        "response_action": "BEK_02.actions.move(item=BEK_02, time_in_seconds=self.second_in_iteration)"
      }

    ],
    "algorithms" : [
      {
        "id":"alg_id_0",
        "title": "Алгоритм движения объекта",
        "description": "Простой встроенный алгоритм в модель движения объекта из точки 1 в точку 2 используя координаты курс и скорость",
        "type": "inner",
        "function": "ModelTasks.move_object",
        "input_parameters": [],
        "output_parameters": [
          {"new_lat": "float"},
          {"new_lon": "float"}
        ]
      },

      {
        "id":"alg_id_9",
        "title": "Алгоритм движения объекта по заданному маршруту",
        "description": "Простой алгоритм движения объекта по заданному маршруту",
        "type": "inner",
        "function": "ModelTasks.move_object_by_path",
        "input_parameters": [],
        "output_parameters": [

          {"new_course": "float"},
          {"new_lat": "float"},
          {"new_lon": "float"},
          {"new_segment_index": "int"}
        ]
      },
      {
        "id":"alg_id_evasive_maneuver",
        "title": "Алгоритм маневрирования, поворачиваем нос в сторону объекта камикадце",
        "description": "Использует алгоритм выбора оптимального курса для столкновения",
        "type": "inner",
        "function": "ModelTasks.calculate_evasive_course",
        "input_parameters": [],
        "output_parameters": [ {"new_course": "float"}]
      },
      {
        "id":"alg_id_kamikaze",
        "title": "Алгоритм расчета курса движения на таран",
        "description": "Использует 2 алгоритма, 1 можем ли догнать, 2 определяем курс на перехвата",
        "type": "inner",
        "function": "ModelTasks.course_to_damage_ram",
        "input_parameters": [],
        "output_parameters": [
          {"new_state": "str"},
          {"new_course": "float"}
        ]
      },
      {
        "id":"alg_id_targeting",
        "title": "Алгоритм целераспределения",
        "description": "Использует питоновску обертку и вызывает с++ функцию из либины",
        "type": "inner",
        "function": "ModelTasks.targeting",
        "input_parameters": [],
        "output_parameters": []
      },
      {
        "id":"alg_id_targeting_cpp",
        "title": "Алгоритм целераспределения",
        "description": "Использует с++ функцию из либины",
        "type": "inner",
        "function": "LIBCPP06.calcObjectDistributionJSON",
        "input_parameters": [],
        "output_parameters": [
          { "list": ["list", { "id1": "str", "id2": "str" }]},
          { "length": "int"}
        ]
      }

    ],
    "files": [
        {
            "id": "LIBCPP01",
            "file_name": "fox-rabbit.so",
			"type":"libcpp",
            "md5_hash": "698d51a19d8a121ce581499d7b701668"
        },{
            "id": "LIBCPP06",
            "file_name": "libtask3_1_1.so.1.0.0",
			"type":"libcpp",
            "md5_hash": "698d51a19d8a121ce581499d7b701669"
        }
    ],
    "simulation_parameters": {
        "time_step": 1,
        "end_condition": "0 == -1",
        "max_iterations": 100000,
        "map_center": "43.58038, 39.49454",
        "map_zoom": 6
    }
}


