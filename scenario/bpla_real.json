{
"scenario_id":"БПЛА",

  "objects":
	[
      {
        "id": "BPLA_00",
        "title": "БПЛА",
        "properties": [
          {"name": "class_code", "value": "10185", "type": "str"},
          {"name": "is_own", "value": 0, "type": "int"},
          {"name": "lat", "value": 43.5149, "type": "float"},
          {"name": "lon", "value": 39.729, "type": "float"},
          {"name": "alt", "value": 500.0, "type": "float"},
          {"name": "course", "value": 198.155, "type": "float"},
          {"name": "angle", "value": 90.40, "type": "float"},
          {"name": "speed", "value": 25.6, "type": "float"},
          {"name": "segment_index", "value": 0, "type": "int"},
          {"name": "image", "value": "ship-blue.png", "type": "str"},
          {"name": "state", "value": "standing", "type": "str"},
          {"name": "geo_path", "type": "feature", "value": {"type": "Feature","properties": {"id": "BPLA_00_path", "class_code": "131405000210000000"}, "geometry": {"coordinates": [],"type": "LineString"} } },
          {"name": "geo_area", "type": "feature", "value": {"type": "Feature","properties": {"id": "BPLA_00_area", "class_code": "31261500011300000000"}, "geometry": {"coordinates": [ [[43.41474, 39.70685, 0], [43.44868, 39.64734, 0], [43.44868, 39.64734, 0], [43.51196, 39.72768, 0], [43.47731, 39.79014, 0]]],"type": "Polygon"}} }
        ],
        "actions": [
          {
            "name": "движение",
            "type": "move",
            "algorithm_id": "alg_id_9",
            "output_mapping": [
              {"course": "new_course"},
              {"lat": "new_lat"},
              {"lon": "new_lon"},
              {"segment_index": "new_segment_index"},
              {"state":  "new_state"}
            ]
          },
          {
            "name": "расчет маршрута",
            "type": "calculate",
            "algorithm_id": "alg_id_66",
            "output_mapping": [
              { "geo_path.geometry.coordinates": "new_geo_path" }
            ]
          }
        ]
      },
		{
			"id":"Model_00",
			"title":"Среда взаимодействия",
			"properties":
            [
              {"name": "current_iteration", "value": 0, "type": "int"},
              {"name": "elapsed_time_in_sec", "value": 0, "type": "int"},
              {"name": "time_per_sec", "value": 1, "type": "int"},
              {"name": "lon", "value": 37.504, "type": "float"},
              {"name": "lat", "value": 42.915, "type": "float"},
              {"name": "alt", "value": 0.0, "type": "float"},
              {"name": "is_caught", "value": -1, "type": "int"},
              {"name": "point_exists", "value": 0, "type": "int"}
            ],
			"actions":[]
		}
	],
    "classes": [],

    "interactions": [
      {
        "source_object_id": "BPLA_00",
        "interaction_type": "calculate",
        "trigger_condition": "BPLA_00.properties['state'] == 'standing' ",
        "response_set_values": "BPLA_00.properties['state'] = 'moving'",
        "response_action": "BPLA_00.properties['geo_path']['geometry']['coordinates'] = BPLA_00.actions.calculate(points=BPLA_00.properties['geo_area']['geometry']['coordinates'][0], h=BPLA_00.properties['alt'], angle=BPLA_00.properties['angle'])"
      },
      {
        "source_object_id": "BPLA_00",
        "interaction_type": "calculate",
        "trigger_condition": "BPLA_00.properties['state'] == 'finished' ",
        "response_set_values": "BPLA_00.properties['state'] = 'standing'; BPLA_00.properties['segment_index'] = 0",
        "response_action": ""
      },
      {
        "source_object_id": "BPLA_00",
        "interaction_type": "moving",
        "trigger_condition": "BPLA_00.properties['state'] == 'moving'",
        "response_action": "BPLA_00.actions.move(item=BPLA_00, path=BPLA_00.properties['geo_path'], time_in_seconds=self.second_in_iteration)"
      }
    ],
    "algorithms" : [
      {
        "id":"alg_id_66",
        "title": "Алгоритм расчета мрашрута для разведки БПЛА в заданном районе",
        "description": "Используется передаваемый файл pkr_object.py",
        "type": "libcpp",
        "function": "LIBCPP02.buildPathExternC_2",
        "input_parameters": [
          {"points": "OUTPUT_STRUCT_POINTS"},
          {"h": "double"},
          {"angle": "double"}
        ],
        "output_parameters": [
            { "new_geo_path": "OUTPUT_STRUCT_POINTS"}
          ]
      },
      {
        "id":"alg_id_0",
        "title": "Алгоритм движения объекта",
        "description": "Простой встроенный алгоритм в модель движения объекта из точки 1 в точку 2 используя координаты курс и скорость",
        "type": "inner",
        "function": "ModelTasks.move_object",
        "input_parameters": [],
        "output_parameters": [
          {"new_lat": "float"},
          {"new_lon": "float"}
        ]
      },

      {
        "id":"alg_id_9",
        "title": "Алгоритм движения объекта по заданному маршруту",
        "description": "Простой алгоритм движения объекта по заданному маршруту",
        "type": "inner",
        "function": "ModelTasks.move_object_by_path",
        "input_parameters": [

        ],
        "output_parameters": [
          {"new_course": "float"},
          {"new_lat": "float"},
          {"new_lon": "float"},
          {"new_segment_index": "int"},
          {"new_state": "str"}
        ]
      }

    ],
    "files": [
        {
            "id": "LIBCPP02",
            "file_name": "libbplatemplate.so.1.0.0",
			"type":"libcpp",
            "md5_hash": "698d51a19d8a121ce581499d7b701668"
        }
    ],
    "simulation_parameters": {
        "time_step": 1,
        "end_condition": "True == False",
        "max_iterations": 100000,
        "map_center": "43.46390, 39.71535",
        "map_zoom": 6
    }
}
