{
  "title": "Модель поведения Корабля + связи + целераспределением БПЛА камикадзе + АК ",
  "type_object": "Надводные корабли:*",
  "object_list": [
    {"name": "SHIP", "description": "Идентификатор Корабля"}
  ],
  "interaction_list": [
    {
      "id": "Корабль - очистка целей",
      "title": "",
      "interaction_type": "moving",
      "response_set_values": "!SHIP!.properties['target_list'] =  []",
      "source_object_id": "!SHIP!",
      "trigger_condition": "CommunicationModel.actions.has_messages(receiver_id=!SHIP!.id, current_time=self.iteration_time) != True"
    },
    {
      "id": "Корабль - получение сообщения от БПЛА",
      "title": "Получено сообщение от БПЛА - цель обнаружена ",
      "interaction_type": "moving",
      "response_set_values": "!SHIP!.properties['target_list'] = CommunicationModel.actions.process_messages(receiver_id=!SHIP!.id, current_time=self.iteration_time)",
      "source_object_id": "!SHIP!",
      "trigger_condition": "CommunicationModel.actions.has_messages(receiver_id=!SHIP!.id, current_time=self.iteration_time) == True and !SHIP!.properties['state'] != 'destroyed'"
    },
    {
      "title": "Обнаружение цели в зоне РЛС",
      "source_object_id": "!SHIP!",
      "interaction_type": "look_detection",
      "trigger_condition": "!SHIP!.actions.look_detection(item1=!SHIP!, item2=self.objects,  rain=WEATHER.properties['rain_intensive'], frog=WEATHER.properties['frog_intensive'], max_distance=!SHIP!.properties['rls_distance']) != []",
      "response_set_values": "!SHIP!.properties['target_list'] = !SHIP!.actions.look_detection(item1=!SHIP!, item2=self.objects,  rain=WEATHER.properties['rain_intensive'], frog=WEATHER.properties['frog_intensive'], max_distance=!SHIP!.properties['rls_distance'])",
      "response_action": ""
    },
    {
      "id": "Корабль - целераспределение",
      "interaction_type": "moving",
      "response_action": "!SHIP!.actions.targeting(target_list=!SHIP!.properties['target_list'], all_items=self.objects, ship=!SHIP!, func_name='', library_name='')",
      "source_object_id": "!SHIP!",
      "title": "Целераспределение",
      "trigger_condition": "!SHIP!.properties['target_list'] != []"
    },
    {
      "id": "Корабль - попадание в носовую часть",
      "interaction_type": "find_path",
      "response_action": "",
      "response_set_values": "!SHIP!.properties['damage_state'] = ''",
      "source_object_id": "!SHIP!",
      "title": "Попадание в носовую часть, снижение прочности корпуса",
      "trigger_condition": "!SHIP!.properties['damage_state'] == 'bow_flash'"
    },
    {
      "id": "Корабль - попадание в центральную часть",
      "interaction_type": "find_path",
      "response_action": "",
      "response_set_values": "!SHIP!.properties['damage_state']='';!SHIP!.properties['state'] = 'destroyed'",
      "source_object_id": "!SHIP!",
      "title": "Попадание в центральную часть, критическое повреждение корпуса",
      "trigger_condition": "!SHIP!.properties['damage_state'] == 'center_flash'"
    },
    {
      "id": "Корабль - попадание в кормовую часть",
      "interaction_type": "find_path",
      "response_action": "",
      "response_set_values": "!SHIP!.properties['damage_state'] = ''",
      "source_object_id": "!SHIP!",
      "title": "Попадание в кормовую часть, снижение скорости",
      "trigger_condition": "!SHIP!.properties['damage_state'] == 'stern_flash'"
    },
    {
      "id": "Корабль - оценка ущерба корпуса",
      "interaction_type": "find_path",
      "response_action": "",
      "response_set_values": "!SHIP!.properties['state'] = 'destroyed'",
      "source_object_id": "!SHIP!",
      "title": "",
      "trigger_condition": "!SHIP!.properties['hull_damage'] >= 1"
    },
    {
      "id": "Корабль - проверка уничтожения",
      "interaction_type": "moving",
      "response_action": "",
      "response_set_values": "!SHIP!.properties['damage_state']='destroyed'",
      "source_object_id": "!BEK!",
      "title": "Объект уничтожен",
      "trigger_condition": "!SHIP!.properties['state'] == 'destroyed' and !SHIP!.properties['damage_state'] != 'destroyed'"
    },
    {
      "id": "Корабль - движение",
      "title": "Движение объекта",
      "interaction_type": "moving",
      "response_action": "!SHIP!.actions.move(item=!SHIP!,  path=!SHIP!.properties['geo_path'],  time_in_seconds=self.second_in_iteration)",
      "source_object_id": "!SHIP!",
      "trigger_condition": "!SHIP!.properties['state'] == 'moving'"
    },
    {
      "id": "Корабль - остановка",
      "title": "Достиг цели",
      "interaction_type": "moving",
      "response_set_values": "!SHIP!.properties['speed'] = 0; !SHIP!.properties['geo_path']['geometry']['coordinates'] = [];",
      "source_object_id": "!SHIP!",
      "trigger_condition": "!SHIP!.properties['state'] == 'finished' and len(!SHIP!.properties['geo_path']['geometry']['coordinates']) > 0"
    },
    {
      "id": "Корабль - захват цели",
      "interaction_type": "detect_enemy",
      "response_set_values": "!SHIP!.properties['target'] = !SHIP!.actions.detect_enemy(item1=!SHIP!, objects=self.objects, rain=WEATHER.properties['rain_intensive'], frog=WEATHER.properties['frog_intensive'], max_distance=!SHIP!.properties['ak_distance']) ",
      "source_object_id": "!SHIP!",
      "title": "Захват цели",
      "trigger_condition": "!SHIP!.properties['target'] == '' and !SHIP!.actions.detect_enemy(item1=!SHIP!, objects=self.objects, rain=WEATHER.properties['rain_intensive'], frog=WEATHER.properties['frog_intensive'], max_distance=!SHIP!.properties['ak_distance']) != '' "
    },
    {
      "id": "Корабль - выстрел из АК-190",
      "interaction_type": "ak_attack",
      "response_action": "",
      "response_set_values": " !SHIP!.properties['ak_bullet_count'] -= !SHIP!.properties['ak_bullet_per_second'];  ",
      "source_object_id": "!SHIP!",
      "title": "Выстрел из АК-190",
      "trigger_condition": "!SHIP!.properties['target'] != '' and !SHIP!.properties['ak_bullet_count'] > 0  "
    },
    {
      "id": "Корабль - оценка эффективности стрельбы АК-190",
      "interaction_type": "ak_attack",
      "response_action": "Model_00.actions.inc_object_prop(item=!SHIP!.properties['target'], prop='hit_count', objects=self.objects, value=Model_00.properties['tmp_int'])",
      "response_set_values": "Model_00.properties['tmp_int'] = Model_00.actions.shoot_in_object(shooter=!SHIP!, target=Model_00.actions.get_object_by_id(object_id=!SHIP!.properties['target'], objects=self.objects), spread_horizontal=!SHIP!.properties['ak_spread_horizontal'], spread_vertical=!SHIP!.properties['ak_spread_vertical'], bullet_count=!SHIP!.properties['ak_bullet_per_second'], max_distance=!SHIP!.properties['ak_distance'])",
      "source_object_id": "!SHIP!",
      "title": "Оценка эффективности стрельбы АК-190",
      "trigger_condition": "!SHIP!.properties['target'] != '' and !SHIP!.properties['ak_bullet_count'] >= 0  "
    },
    {
      "id": "Корабль - цель уничтожена",
      "interaction_type": "detect_enemy",
      "response_action": "",
      "response_set_values": "!SHIP!.properties['target'] = ''",
      "source_object_id": "!SHIP!",
      "title": "Цель уничтожена",
      "trigger_condition": "Model_00.actions.get_object_prop(item=!SHIP!.properties['target'], prop='state', objects=self.objects, type_value='str') in ['destroyed', 'destroyed_bek'] "
    },
    {
      "id": "Корабль - маневр уклонения",
      "interaction_type": "evasive_maneuver",
      "response_set_values": "!SHIP!.properties['speed'] = !SHIP!.properties['speed_maneuver']; !SHIP!.properties['state'] = 'moving'; ",
      "source_object_id": "!SHIP!",
      "title": "Маневр уклонения",
      "trigger_condition": "!SHIP!.properties['state'] != 'destroyed' and !SHIP!.actions.evasive_maneuver(item=!SHIP!, objects=self.objects, type_danger=['БЭК'], min_distance=!SHIP!.properties['danger_distance'], rain=WEATHER.properties['rain_intensive'], frog=WEATHER.properties['frog_intensive'], time_in_seconds=300, restricted_area=Model_00.actions.filter_by_type(objects=self.features, obj_type=\"RESTRICTED_AREA\")) "
    }
  ]
}
